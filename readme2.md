# Code analysis
## prep-hup 

**By: Nuwas Comapany**

## Introduction
This document contains results of the code analysis of prep-hup



## Configuration

- Quality Profiles
    - Names: Sonar way [CSS]; Sonar way [JavaScript]; Sonar way [PHP]; Sonar way [Python]; Sonar way [TypeScript]; Sonar way [HTML]; 
    - Files: AZJSgRTcE1EVebWCtkBj.json; AZJSgRX8E1EVebWCtkQb.json; AZJSgRkHE1EVebWCtlNe.json; AZJSgRZfE1EVebWCtkZ3.json; AZJSgRptE1EVebWCtlgq.json; AZJSgRhBE1EVebWCtlDN.json; 


 - Quality Gate
    - Name: Sonar way
    - File: Sonar way.xml

## Synthesis

### Analysis Status

Reliability | Security | Security Review | Maintainability |
:---:|:---:|:---:|:---:
C | D | E | A |

### Quality gate status

| Quality Gate Status | OK |
|-|-|



### Metrics

Coverage | Duplications | Comment density | Median number of lines of code per file | Adherence to coding standard |
:---:|:---:|:---:|:---:|:---:
0.0 % | 3.9 % | 3.5 % | 53.0 | 98.6 %

### Tests

Total | Success Rate | Skipped | Errors | Failures |
:---:|:---:|:---:|:---:|:---:
0 | 0 % | 0 | 0 | 0

### Detailed technical debt

Reliability|Security|Maintainability|Total
---|---|---|---
0d 0h 18min|0d 0h 40min|0d 5h 38min|0d 6h 36min


## Issues

### Issues count by severity and types

Type / Severity|INFO|MINOR|MAJOR|CRITICAL|BLOCKER
---|---|---|---|---|---
BUG|0|0|6|0|0
VULNERABILITY|0|0|0|2|0
CODE_SMELL|0|37|28|12|0


### Issues List

Name|Description|Type|Severity|Number
---|---|---|---|---
"<!DOCTYPE>" declarations should appear before "<html>" tags|The &lt;!DOCTYPE&gt; declaration tells the web browser which (X)HTML version is being used on the page, and therefore how to interpret <br /> the various elements. <br /> Validators also rely on it to know which rules to enforce. <br /> It should always preceed the &lt;html&gt; tag. <br /> Noncompliant Code Example <br />  <br /> &lt;html&gt;  &lt;!-- Noncompliant --&gt; <br /> ... <br /> &lt;/html&gt; <br />  <br /> Compliant Solution <br />  <br /> &lt;!DOCTYPE html&gt; <br /> &lt;html&gt;  &lt;!-- Compliant --&gt; <br /> ... <br /> &lt;/html&gt; <br /> |BUG|MAJOR|2
"<html>" element should have a language attribute|The &lt;html&gt;&nbsp;element should provide the lang and/or xml:lang attribute in order to identify the <br /> default language of a document. <br /> It enables assistive technologies, such as screen readers,&nbsp;to provide a comfortable reading experience by adapting the pronunciation and <br /> accent to the language. It also helps braille translation software, telling it to switch the control codes for accented characters for instance. <br /> Other benefits of marking the language include: <br />  <br />    assisting user agents in providing dictionary definitions or helping users benefit from translation tools.  <br />    improving search engine ranking. <br />    <br />  <br /> Both the lang and the xml:lang attributes can take only one value. <br /> &nbsp; <br /> Noncompliant Code Example <br />  <br /> &lt;!DOCTYPE html&gt; <br /> &lt;html&gt; &lt;!-- Noncompliant --&gt; <br /> &nbsp;&nbsp;&nbsp; &lt;head&gt; <br />  &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;title&gt;A page written in english&lt;/title&gt; <br />  &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;meta content="text/html; charset=utf-8" /&gt; <br /> &nbsp;&nbsp;&nbsp; &lt;/head&gt; &nbsp; <br />  <br />  <br /> &nbsp;&nbsp;&nbsp; &lt;body&gt; &nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; ... &nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &lt;/body&gt; <br /> &lt;/html&gt; <br />  <br /> Compliant Solution <br />  <br /> &lt;!DOCTYPE html&gt; <br /> &lt;html lang="en"&gt; <br /> &nbsp;&nbsp;&nbsp; &lt;head&gt; <br />  &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;title&gt;A page written in english&lt;/title&gt; <br />  &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;meta content="text/html; charset=utf-8" /&gt; <br /> &nbsp;&nbsp;&nbsp; &lt;/head&gt; &nbsp; <br />  <br />  <br /> &nbsp;&nbsp;&nbsp; &lt;body&gt; &nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; ... &nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &lt;/body&gt; <br /> &lt;/html&gt; <br />  <br />  <br /> &lt;!DOCTYPE html&gt; <br /> &lt;html lang="en" xml:lang="en"&gt; <br /> &nbsp;&nbsp;&nbsp; &lt;head&gt; <br />  &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;title&gt;A page written in english&lt;/title&gt; <br />  &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;meta content="text/html; charset=utf-8" /&gt; <br /> &nbsp;&nbsp;&nbsp; &lt;/head&gt; &nbsp; <br />  <br />  <br /> &nbsp;&nbsp;&nbsp; &lt;body&gt; &nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; ... &nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &lt;/body&gt; <br /> &lt;/html&gt; <br />  <br /> See <br />  <br />    WCAG2, H57 - Using language attributes on the html element  <br />    WCAG2, 3.1.1 - Language of Page  <br /> |BUG|MAJOR|4
Control structures should use curly braces|While not technically incorrect, the omission of curly braces can be misleading, and may lead to the introduction of errors during maintenance. <br /> Noncompliant Code Example <br />  <br /> if (condition)  // Noncompliant <br />   executeSomething(); <br />  <br /> Compliant Solution <br />  <br /> if (condition) { <br />   executeSomething(); <br /> } <br /> |CODE_SMELL|CRITICAL|6
"SystemExit" should be re-raised|SystemExit&nbsp;is raised when sys.exit() is called. This exception is expected to propagate up until the <br /> application stops. It is ok to catch it when a clean-up is necessary but it should be raised again immediately. <br /> A bare except: statement, i.e. an <br /> except without any exception class, is equivalent to except BaseException. Both statements will catch every <br /> exception, including SystemExit. It is recommended to catch instead a specific exception. If it is not possible, the exception should be <br /> raised again. <br /> Note that it is also a good idea to reraise the KeyboardInterrupt exception. <br /> This rule raises an issue when a bare except:, an except BaseException or an except SystemExit don’t reraise <br /> the exception caught. <br /> Noncompliant Code Example <br />  <br /> try: <br />     open("foo.txt", "r") <br /> except SystemExit:  # Noncompliant <br />     pass <br /> except KeyboardInterrupt:  # No issue raised but be careful when you do this <br />     pass <br />  <br /> try: <br />     open("bar.txt", "r") <br /> except BaseException:  # Noncompliant <br />     pass <br /> except:  # Noncompliant <br />     pass <br />  <br /> Compliant Solution <br />  <br /> try: <br />     open("foo.txt", "r") <br /> except SystemExit: <br />     # clean-up <br />     raise <br /> except KeyboardInterrupt: <br />     # clean-up <br />     raise <br />  <br /> try: <br />     open("bar.txt", "r") <br /> except BaseException as e: <br />     # clean-up <br />     raise e <br /> except: # Noncompliant <br />     # clean-up <br />     raise <br />  <br /> # or use a more specific exception <br />  <br /> try: <br />     open("bar.txt", "r") <br /> except FileNotFoundError: <br />     # process the exception <br />  <br /> See <br />  <br />    PEP 352 - Required Superclass for Exceptions  <br />    Python Documentation - Built-in exceptions  <br />    Python Documentation - The try statement <br />    <br />    MITRE, CWE-391 - Unchecked Error Condition  <br /> |CODE_SMELL|CRITICAL|1
Cognitive Complexity of functions should not be too high|Cognitive Complexity is a measure of how hard the control flow of a function is to understand. Functions with high Cognitive Complexity will be <br /> difficult to maintain. <br /> See <br />  <br />    Cognitive Complexity  <br /> |CODE_SMELL|CRITICAL|5
Selectors should not be duplicated|Duplication of selectors might indicate a copy-paste mistake. The rule detects the following kinds of duplications: <br />  <br />    within a list of selectors in a single rule set  <br />    for duplicated selectors in different rule sets within a single stylesheet.  <br />  <br /> Noncompliant Code Example <br />  <br /> .foo, .bar, .foo { ... }  /* Noncompliant */ <br />  <br /> .class1 { ... } <br /> .class1 { ... }  /* Noncompliant */ <br />  <br /> Compliant Solution <br />  <br /> .foo, .bar { ... } <br />  <br /> .class1 { ... } <br /> .class2 { ... } <br /> |CODE_SMELL|MAJOR|4
Builtins should not be shadowed by local variables|Shadowing a builtin makes your code more difficult to read and maintain. It may also be a source of bugs as you can reference the builtin by <br /> mistake. <br /> It is sometimes ok to shadow a builtin to improve the readability of a public API or to support multiple versions of a library. In these cases the <br /> value is higher than the maintainability cost. Just be careful when you do it. <br /> It is not ok to shadow builtins with variables which are local to a function or method. These variables are not public and can be easily renamed, <br /> thus reducing the confusion and making the code less error-prone. <br /> This rule raises an issue when the name of a local variable matches the name of a builtin. <br /> Noncompliant Code Example <br />  <br /> def a_function(): <br />     int = 42  # Noncompliant; int is a builtin <br />  <br /> Compliant Solution <br />  <br /> def a_function(): <br />     value = 42 <br />  <br /> See <br />  <br />    Python documentation - Built-in Types  <br />    Python documentation - Built-in Functions  <br /> |CODE_SMELL|MAJOR|2
Sections of code should not be commented out|Programmers should not comment out code as it bloats programs and reduces readability. <br /> Unused code should be deleted and can be retrieved from source control history if required.|CODE_SMELL|MAJOR|12
Unused assignments should be removed|A dead store happens when a local variable is assigned a value that is not read by any subsequent instruction. Calculating or retrieving a value <br /> only to then overwrite it or throw it away, could indicate a serious error in the code. Even if it’s not an error, it is at best a waste of resources. <br /> Therefore all calculated values should be used. <br /> Noncompliant Code Example <br />  <br /> i = a + b; // Noncompliant; calculation result not used before value is overwritten <br /> i = compute(); <br />  <br /> Compliant Solution <br />  <br /> i = a + b; <br /> i += compute(); <br />  <br /> Exceptions <br />  <br />    This rule ignores initializations to -1, 0, 1, undefined, [], {}, true, false and "".  <br />    Variables that start with an underscore (e.g. '_unused') are ignored.  <br />    Assignment of null is ignored because it is sometimes used to help garbage collection  <br />    Increment and decrement expressions are ignored because they are often used idiomatically instead of x+1  <br />    This rule also ignores variables declared with object destructuring using rest syntax (used to exclude some properties from object):  <br />  <br />  <br /> let {a, b, ...rest} = obj; // 'a' and 'b' are ok <br /> doSomething(rest); <br />  <br /> let [x1, x2, x3] = arr;    // but 'x1' is noncompliant, as omitting syntax can be used: "let [, x2, x3] = arr;" <br /> doSomething(x2, x3); <br />  <br /> See <br />  <br />    MITRE, CWE-563 - Assignment to Variable without Use ('Unused Variable')  <br /> |CODE_SMELL|MAJOR|7
Ternary operators should not be nested|Just because you can do something, doesn’t mean you should, and that’s the case with nested ternary operations. Nesting ternary operators <br /> results in the kind of code that may seem clear as day when you write it, but six months later will leave maintainers (or worse - future you) <br /> scratching their heads and cursing. <br /> Instead, err on the side of clarity, and use another line to express the nested operation as a separate statement. <br /> Noncompliant Code Example <br />  <br /> function getReadableStatus(job) { <br />   return job.isRunning() ? "Running" : job.hasErrors() ? "Failed" : "Succeeded ";  // Noncompliant <br /> } <br />  <br /> Compliant Solution <br />  <br /> function getReadableStatus(job) { <br />   if (job.isRunning()) { <br />     return "Running"; <br />   } <br />   return job.hasErrors() ? "Failed" : "Succeeded"; <br /> } <br />  <br /> Exceptions <br /> This rule does not apply in JSX expressions to support conditional rendering and conditional attributes. <br />  <br /> return ( <br /> &lt;&gt; <br />   {isLoading ? ( <br />     &lt;Loader active /&gt; <br />   ) : ( <br />     &lt;Panel label={isEditing ? 'Open' : 'Not open'}&gt; <br />       &lt;a&gt;{isEditing ? 'Close now' : 'Start now'}&lt;/a&gt; <br />       &lt;Checkbox onClick={!saving ? setSaving(saving =&gt; !saving) : null} /&gt; <br />     &lt;/Panel&gt; <br />   )} <br /> &lt;/&gt; <br /> ); <br /> |CODE_SMELL|MAJOR|2
Literals should not be thrown|It is a bad practice to throw something that’s not derived at some level from Error. If you can’t find an existing <br /> Error type that suitably conveys what you need to convey, then you should extend Error to create one. <br /> Specifically, part of the point of throwing Errors is to communicate about the conditions of the error, but literals have far less <br /> ability to communicate meaningfully than Errors because they don’t include stacktraces. <br /> Noncompliant Code Example <br />  <br /> throw 404;                              // Noncompliant <br /> throw "Invalid negative index.";        // Noncompliant <br />  <br /> Compliant Solution <br />  <br /> throw new Error("Status: " + 404); <br /> throw new Error("Invalid negative index.");{code} <br /> |CODE_SMELL|MAJOR|1
Multi-line comments should not be empty|An empty multi-line comment is likely to be a mistake and doesn’t help to improve the readability of the code. For these reasons, it should be <br /> removed. <br /> Noncompliant Code Example <br />  <br /> /* */ <br />  <br /> /* <br />  <br />  */ <br /> |CODE_SMELL|MINOR|2
Files should contain an empty newline at the end|Some tools work better when files end with an empty line. <br /> This rule simply generates an issue if it is missing. <br /> For example, a Git diff looks like this if the empty line is missing at the end of the file: <br />  <br /> +class Test { <br /> +} <br /> \ No newline at end of file <br /> |CODE_SMELL|MINOR|1
Lines should not end with trailing whitespaces|Trailing whitespaces are simply useless and should not stay in code. They may generate noise when comparing different versions of the same <br /> file. <br /> If you encounter issues from this rule, this probably means that you are not using an automated code formatter - which you should if you have the <br /> opportunity to do so. <br /> Exceptions <br /> Lines containing only whitespaces.|CODE_SMELL|MINOR|1
Closing tag "?>" should be omitted on files containing only PHP|According to the PSR2 coding standard: <br />  <br />   The closing ?&gt; tag should be omitted from files containing only PHP. <br />  <br /> According to the PHP manual: <br />  <br />   in some cases omitting it is helpful when using include or require, so unwanted whitespace will not occur at the end of files, and you will still <br />   be able to add headers to the response later. It is also handy if you use output buffering, and would not like to see added unwanted whitespace at <br />   the end of the parts generated by the included files. <br /> |CODE_SMELL|MINOR|1
Source code should comply with formatting standards|Shared coding conventions make it possible for a team to collaborate efficiently. This rule raises issues for failures to comply with formatting <br /> standard. The default parameter values conform to the PSR2 standard. <br /> Noncompliant Code Example <br /> With the default PSR2 parameter values: <br />  <br /> use FooClass;              // Noncompliant; the "use" declaration should be placed after the "namespace" declaration <br />  <br /> namespace Vendor\Package; <br /> use FooClass;              // Noncompliant; the "namespace" declaration should be followed by a blank line <br /> $foo = 1;                  // Noncompliant; the "use" declaration should be followed by a blank line <br />  <br /> class ClassA {             // Noncompliant; an open curly brace should be at the beginning of a new line for classes and functions <br />   function my_function(){  // Noncompliant; curly brace on wrong line <br />     if ($firstThing)       // Noncompliant; an open curly brace should be at the end of line for a control structure <br />     { <br />       ... <br />     } <br />  <br />     if ($secondThing)    { // Noncompliant; there should be exactly one space between the closing parenthesis and the opening curly brace <br />       ... <br />     } <br />  <br />     if($thirdThing) {      // Noncompliant; there should be exactly one space between the control structure keyword and the opening parenthesis <br />       ... <br />     } <br />     else {                 // Noncompliant; the close curly brace and the next "else" (or "catch" or "finally") keyword should be located on the same line <br />       ... <br />     } <br />  <br />     try{                   // Noncompliant; there should be exactly one space between the control structure keyword and the curly brace <br />       ... <br />     } catch (Exception $e) { <br />     } <br />  <br />     analyse( $fruit ) ;    // Noncompliant; there should not be any space after the opening parenthesis and before the closing parenthesis <br />  <br />     for ($i = 0;$i &lt; 10;   $i++) { // Nomcompliant; there should be exactly one space after each ";" in the {{for}} statement <br />       ... <br />     } <br />  <br />     pressJuice($apply ,$orange);    // Noncompliant; the comma should be followed by one space and not preceded by any <br />  <br />     do_something ();       // Noncompliant; there should not be any space after the method name <br />  <br />     foreach ($fruits    as $fruit_key =&gt;     $fruit) {  // Noncompliant; in the foreach statement there should be one space before and after "as" keyword and "=&gt;" operator <br />       ... <br />     } <br />   } <br /> } <br />  <br /> class ClassB <br /> extends ParentClass  // Noncompliant; the class name and the "extends" / "implements" keyword should be on the same line <br /> { <br />   ... <br /> } <br />  <br /> class ClassC extends ParentClass implements \ArrayAccess, \Countable, <br />     \Serializable    // Noncompliant; the list of implemented interfaces should be correctly indented <br /> { <br />  <br />   public function aVeryLongMethodName(ClassTypeHint $arg1, // Noncompliant; the arguments in a method declaration should be correctly indented <br />     &amp;$arg2, array $arg3 = []) { <br />  <br />     $noArgs_longVars = function () use ($longVar1,         // Noncompliant; the arguments in a function declaration should be correctly indented <br />         $longerVar2, <br />         $muchLongerVar3 <br />     ) { <br />       ... <br />     }; <br />  <br />     $foo-&gt;bar($longArgument,    // Noncompliant; the arguments in a method call should be correctly indented <br />       $longerArgument, <br />       $muchLongerArgument);     // Noncompliant; the closing parenthesis should be placed on the next line <br />  <br />     $closureWithArgsAndVars = function($arg1, $arg2)use   ($var1, $var2) {  // Noncompliant; the closure declaration should be correctly spaced - see (5) <br />       ... <br />     }; <br />   } <br /> } <br />  <br /> Compliant Solution <br />  <br /> namespace Vendor\Package; // Compliant; the "namespace" declaration is followed by a blank line <br />  <br /> use FooClass;             // Compliant; the "use" declaration is placed after the "namespace" declaration <br />                           // Compliant; the "use" declaration is followed by a blank line <br /> $foo = 1; <br />  <br /> class ClassA <br /> {                         // Compliant; the open curly brace is at the beginning of a new line for the class <br />   function my_function() <br />   {                       // Compliant; the open curly brace is at the beginning of a new line for the function <br />     if ($firstThing) {    // Compliant; the open curly brace is at the end of line for the control structure <br />       ... <br />     } <br />  <br />     if ($secondThing) {   // Compliant; there is exactly one space between the closing parenthesis and the opening curly brace <br />       ... <br />     } <br />  <br />     if ($thirdThing) {    // Compliant; there is exactly one space between the control structure keyword and the opening parenthesis <br />       ... <br />     } else {              // Compliant; the close curly brace and the next "else" (or "catch" or "finally") keyword are located on the same line <br />       ... <br />     } <br />  <br />     try {                 // Compliant; there is exactly one space between the control structure keyword and the curly brace <br />       ... <br />     } catch (Exception $e) { <br />       ... <br />     } <br />  <br />     analyse($fruit);      // Compliant: there is no space after the opening parenthesis, nor before the closing parenthesis <br />  <br />     for ($i = 0; $i &lt; 10; $i++) { // Compliant: there is exactly one space after each ";" in the {{for}} statement <br />       ... <br />     } <br />  <br />     pressJuice($apply, $orange);   // Compliant; the comma is followed by one space and is not preceded by any <br />  <br />     do_something();       // Compliant; there is no space after the method name <br />  <br />     foreach ($fruits as $fruit_key =&gt; $fruit) {  // Compliant; in the foreach statement there is one space before and after "as" keyword and "=&gt;" operator <br />       ... <br />     } <br />   } <br /> } <br />  <br /> /* The idea here is to make it obvious at first glance that a class extends <br />  * some other classes and/or implements some interfaces. The names of <br />  * extended classes or implemented interfaces can be located on subsequent lines. <br />  */ <br /> class ClassB1 extends ParentClass // Compliant; the class name and the "extends" (or "implements") keyword are located on the same line <br /> { <br />   ... <br /> } <br />  <br /> class ClassB2 extends             // Compliant; the class name and the "extends" (or "implements") keyword are located on the same line <br /> ParentClass { <br />   ... <br /> } <br />  <br /> /* Lists of implements may be split across multiple lines, where each subsequent line <br />  * is indented once. When doing so, the first item in the list should be on the next line, <br />  * and there should be only one interface per line. <br />  */ <br /> class ClassC extends ParentClass implements <br />     \ArrayAccess,         // Compliant; the list of implemented interfaces is correctly indented <br />     \Countable, <br />     \Serializable <br /> { <br />   /* Argument lists may be split across multiple lines, where each subsequent line <br />    * is indented once. When doing so, the first item in the list should be on the next line, <br />    * and there should be only one argument per line. Also, when the argument list is <br />    * split across multiple lines, the closing parenthesis and opening brace should be <br />    * placed together on their own line with one space between them. <br />    */ <br />   public function aVeryLongMethodName( <br />     ClassTypeHint $arg1,  // Compliant; the arguments in a method/function declaration are correctly indented <br />       &amp;$arg2, <br />       array $arg3 = [] <br />     ) { <br />       $noArgs_longVars = function () use ( <br />         $longVar1,        // Compliant; the arguments in a method/function declaration are correctly indented <br />         $longerVar2, <br />         $muchLongerVar3 <br />       ) { <br />         ... <br />       }; <br />  <br />  <br />     /* Argument lists may be split across multiple lines, where each subsequent line is <br />      * indented once. When doing so, the first item in the list should be on the next line, <br />      * and there should be only one argument per line. <br />      */ <br />     $foo-&gt;bar( <br />       $longArgument,       // Compliant; the arguments in the method call are be correctly indented <br />       $longerArgument, <br />       $muchLongerArgument <br />     );                     // Compliant; the closing parenthesis is placed on a separate line <br />  <br />     /* Closures should be declared with a space after the "function" keyword, <br />      * and a space before and after the "use" keyword. <br />      */ <br />     $closureWithArgsAndVars = function ($arg1, $arg2) use ($var1, $var2) { // Compliant; the closure declaration is correctly spaced <br />       ... <br />     }; <br />   } <br /> } <br /> |CODE_SMELL|MINOR|19
Boolean checks should not be inverted|It is needlessly complex to invert the result of a boolean comparison. The opposite comparison should be made instead. <br /> Noncompliant Code Example <br />  <br /> if not a == 2:        # Noncompliant <br />     b = not i &lt; 10    # Noncompliant <br />  <br /> Compliant Solution <br />  <br /> if a != 2 : <br />     b = i &gt;= 10 <br /> |CODE_SMELL|MINOR|2
Boolean literals should not be used in comparisons|Boolean literals should be avoided in comparison expressions == and != to improve code readability. <br /> This rule also reports on redundant boolean operations. <br /> Noncompliant Code Example <br />  <br /> let someValue = "0"; <br /> // ... <br />  <br /> if (someValue == true) { /* ... */ } <br /> if (someBooleanValue != true) { /* ... */ } <br /> doSomething(!false); <br />  <br /> Compliant Solution <br />  <br /> if (someValue &amp;&amp; someValue != "0") { /* ... */ } <br /> if (!someBooleanValue) { /* ... */ } <br /> doSomething(true); <br /> |CODE_SMELL|MINOR|2
Unnecessary imports should be removed|There’s no reason to import modules you don’t use; and every reason not to: doing so needlessly increases the load. <br /> Noncompliant Code Example <br />  <br /> import A from 'a';      // Noncompliant, A isn't used <br /> import { B1 } from 'b'; <br />  <br /> console.log(B1); <br />  <br /> Compliant Solution <br />  <br /> import { B1 } from 'b'; <br />  <br /> console.log(B1); <br /> |CODE_SMELL|MINOR|6
Imports from the same modules should be merged|Multiple imports from the same module should be merged together to improve readability. <br /> Noncompliant Code Example <br />  <br /> import { B1 } from 'b'; <br /> import { B2 } from 'b'; // Noncompliant <br />  <br /> Compliant Solution <br />  <br /> import { B1, B2 } from 'b'; <br /> |CODE_SMELL|MINOR|1
Redundant casts and non-null assertions should be avoided|The TypeScript compiler automatically casts a variable to the relevant type inside conditionals where it is possible to infer the type (because <br /> typeof, instanceof, etc was used). This compiler feature makes casts and not-null assertions unnecessary. <br /> Noncompliant Code Example <br />  <br /> function getName(x?: string &#124 UserName) { <br />   if (x) { <br />     console.log("Getting name for " + x!); // Noncompliant <br />  <br />     if (typeof x === "string") <br />       return (x as string); // Noncompliant <br />     else <br />       return (x as UserName).name; // Noncompliant <br />   } <br />   return "NoName"; <br /> } <br />  <br /> Compliant Solution <br />  <br /> function getName(x?: string &#124 UserName) { <br />   if (x) { <br />     console.log("Getting name for " + x); <br />  <br />     if (typeof x === "string") <br />       return x; <br />     else <br />       return x.name; <br />   } <br />   return "NoName"; <br /> } <br /> |CODE_SMELL|MINOR|2
File uploads should be restricted|These minimum restrictions should be applied when handling file uploads: <br />  <br />    the file upload folder to restrict untrusted files to a specific folder.  <br />    the file extension of the uploaded file to prevent remote code execution.  <br />  <br /> Also the size of the uploaded file should be limited to prevent denial of service attacks. This requirement is covered by the rule <br /> S5693. <br /> Noncompliant Code Example <br /> formidable module: <br />  <br /> const Formidable = require('formidable'); <br />  <br /> const form = new Formidable(); // Noncompliant, this form is not safe <br /> form.uploadDir = ""; // because upload dir is not defined (by default os temp dir: /var/tmp or /tmp) <br /> form.keepExtensions = true; // and file extensions are kept <br />  <br /> multer (Express.js middleware) module: <br />  <br /> const multer = require('multer'); <br />  <br /> let diskStorage = multer.diskStorage({ // Noncompliant: no destination specified <br />   filename: (req, file, cb) =&gt; { <br />     const buf = crypto.randomBytes(20); <br />     cb(null, buf.toString('hex')) <br />   } <br /> }); <br />  <br /> // This upload is not safe as no destination specified, /var/tmp or /tmp will be used <br /> let diskupload = multer({ <br />   storage: diskStorage, <br /> }); <br />  <br /> Compliant Solution <br /> formidable module: <br />  <br /> const Formidable = require('formidable'); <br />  <br /> const form = new Formidable(); // Compliant <br /> form.uploadDir = "./uploads/"; <br /> form.keepExtensions = false; <br />  <br /> multer (Express.js middleware) module: <br />  <br /> const multer = require('multer'); <br />  <br /> let diskStorage = multer.diskStorage({  // Compliant <br />   filename: (req, file, cb) =&gt; { <br />     const buf = crypto.randomBytes(20); <br />     cb(null, buf.toString('hex')) <br />   }, <br />   destination: (req, file, cb) =&gt; { <br />     cb(null, './uploads/') <br />   } <br /> }); <br />  <br /> let diskupload = multer({ <br />   storage: diskStorage, <br /> }); <br />  <br /> See <br />  <br />    OWASP Top 10 2021 Category A4 - Insecure Design  <br />    MITRE, CWE-434 - Unrestricted Upload of File with Dangerous Type  <br />    MITRE, CWE-400 - Uncontrolled Resource Consumption  <br />    OWASP Unrestricted File Upload - Unrestricted File <br />   Upload  <br />    SANS Top 25 - Insecure Interaction Between Components  <br /> |VULNERABILITY|CRITICAL|1
Encryption algorithms should be used with secure mode and padding scheme|Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity. <br />  <br />    For block cipher encryption algorithms (like AES): <br />      <br />        The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block <br />       always gets encrypted to the same ciphertext block. This mode should never be used.  <br />        The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to padding oracle attacks when used with padding. Using CBC along with Message <br />       Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s <br />       recommended to avoid CBC with padding completely.  <br />        The GCM (Galois Counter Mode) mode which works <br />       internally with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality. <br />       Other similar modes are CCM, CWC, EAX, IAPM and OCB.  <br />        <br />    For RSA encryption algorithm, the recommended padding scheme is OAEP.  <br />  <br /> Noncompliant Code Example <br /> crypto built-in module: <br />  <br /> crypto.createCipheriv("AES-128-CBC", key, iv); // Noncompliant: CBC with PKCS5/7 (set by default) is vulnerable to oracle padding attacks <br /> crypto.createCipheriv("AES-128-ECB", key, ""); // Noncompliant: ECB doesn't provide serious message confidentiality <br />  <br /> Compliant Solution <br /> crypto built-in module: <br />  <br /> crypto.createCipheriv("AES-256-GCM", key, iv); <br />  <br /> See <br />  <br />    OWASP Top 10 2021 Category A2 - Cryptographic Failures  <br />    OWASP Top 10 2017 Category A6 - Security <br />   Misconfiguration  <br />    MITRE, CWE-327 - Use of a Broken or Risky Cryptographic Algorithm  <br />    SANS Top 25 - Porous Defenses  <br /> |VULNERABILITY|CRITICAL|1


## Security Hotspots

### Security hotspots count by category and priority

Category / Priority|LOW|MEDIUM|HIGH
---|---|---|---
LDAP Injection|0|0|0
Object Injection|0|0|0
Server-Side Request Forgery (SSRF)|0|0|0
XML External Entity (XXE)|0|0|0
Insecure Configuration|0|0|0
XPath Injection|0|0|0
Authentication|0|0|0
Weak Cryptography|0|4|0
Denial of Service (DoS)|0|1|0
Log Injection|0|0|0
Cross-Site Request Forgery (CSRF)|0|0|0
Open Redirect|0|0|0
Permission|0|0|0
SQL Injection|0|0|0
Encryption of Sensitive Data|1|0|0
Traceability|0|0|0
Buffer Overflow|0|0|0
File Manipulation|0|0|0
Code Injection (RCE)|0|0|0
Cross-Site Scripting (XSS)|0|0|0
Command Injection|0|0|0
Path Traversal Injection|0|0|0
HTTP Response Splitting|0|0|0
Others|2|0|0


### Security hotspots

Category|Name|Priority|Severity|Count
---|---|---|---|---
Others|Authorizing an opened window to access back to the originating window is security-sensitive|LOW|MINOR|1
Weak Cryptography|Using pseudorandom number generators (PRNGs) is security-sensitive|MEDIUM|CRITICAL|4
Denial of Service (DoS)|Allowing requests with excessive content length is security-sensitive|MEDIUM|MAJOR|1
Others|Disabling resource integrity features is security-sensitive|LOW|MINOR|1
Encryption of Sensitive Data|Using clear-text protocols is security-sensitive|LOW|CRITICAL|1
